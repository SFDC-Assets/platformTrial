<aura:component implements="flexipage:availableForAllPageTypes, force:appHostable" extends="c:promiseErrorHandler" controller="TrialUtilities">

	<aura:attribute name="trialFields" type="object" />
	<aura:attribute name="trialFieldsE" type="object" />
	<aura:attribute name="error" type="object" />
	<aura:attribute name="errorE" type="object" />

	<aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

	<aura:attribute name="recordId" type="id"/>
	<c:LightningErrorHandler aura:id="leh"/>

	<force:recordData fields="['Paths_Chosen__c', 'WelcomeViewed__c', 'Video_Watched__c', 'Current_Step__c']" mode="VIEW" targetFields="{!v.trialFields}" aura:id="trialRec" targetError="{!v.error}" recordUpdated="{!c.doneYet}"/>

	<force:recordData mode="EDIT" targetFields="{!v.trialFieldsE}" aura:id="trialRecE" fields="['Paths_Chosen__c', 'Video_Watched__c', 'WelcomeViewed__c', 'Path_See_Apps__c', 'Path_Build_Apps__c', 'Path_IT_Tools__c', 'Path_Mobile__c', 'Current_Step__c']" targetError="{!v.errorE}"/>

	<lightning:overlayLibrary aura:id="overlayLibModal"/>
  <!-- welcome message -->
	<aura:if isTrue="{!and(v.trialFields, !v.trialFields.WelcomeViewed__c)}">

		<lightning:layout horizontalAlign="spread" verticalAlign="stretch">

			<lightning:layoutItem size="7" class="background">
				<lightning:layout horizontalAlign="center" verticalAlign="stretch" class="fullHeight">
					<lightning:layoutItem size="6" class="slds-align_absolute-center">
						<img src="https://raw.githubusercontent.com/mshanemc/platformTrial/master/assets/welcome-image.png" />
					</lightning:layoutItem>
				</lightning:layout>
			</lightning:layoutItem>

			<lightning:layoutItem size="5" padding="around-medium">
				<!-- <h1 class="slds-text-heading_large slds-m-bottom_large">Welcome to the Salesforce Platform Free Trial</h1> -->

				<!-- <p class="slds-text-heading_small slds-m-vertical_medium">Please watch this orientation video to get you started.</p> -->
				<lightning:layout verticalAlign="stretch" multipleRows="true" class="fullHeight">

					<lightning:layoutItem size="12" flexibility="no-flex" class="slds-align-top">
						<h1 class="slds-text-heading_medium"><b>Welcome to the Salesforce Platform Free Trial</b></h1>
					</lightning:layoutItem>

					<lightning:layoutItem size="12" flexibility="grow" class="slds-text-heading_medium">

						<p class="slds-m-vertical_medium">Meet the Salesforce SuperRangers! They're a team of superheroes working to protect the world from the bad guys. </p>
						<p class="slds-m-vertical_medium">They'd rather be out fighting crime than working in the office filling out orders for new grappling hooks, lasers and utility
						belts.</p>
						<p class="slds-m-vertical_medium">In this trial you'll join the SuperRangers team and see how they've customized Salesforce to their unique needs. Your mission,
						should you choose to accept it, is to make saving the world easier.</p>
					</lightning:layoutItem>

					<lightning:layoutItem size="12" flexibility="no-flex" class="slds-align-bottom">
						<lightning:button variant="brand" label="Let's go!" class="slds-button_huge" onclick="{!c.storySet}" />
					</lightning:layoutItem>
				</lightning:layout>
			</lightning:layoutItem>

		</lightning:layout>

		<c:UniversalAnalyticsPageTag pageName="/welcome/welcome" pageTitle="welcome"/>
	</aura:if>

	<!-- path selection -->
	<aura:if isTrue="{!and(v.trialFields, and(v.trialFields.WelcomeViewed__c, !v.trialFields.Paths_Chosen__c))}">

		<h1 class="slds-text-heading_medium slds-m-top_xx-large slds-text-align_center"><b>What would you like to see?</b></h1>
		<p class="slds-m-bottom_xx-large slds-text-align_center">Click all that apply. We'll make sure that your tour focuses on those items.</p>

		<fieldset class="slds-form-element">
			<div class="slds-form-element__control">
				<div class="slds-visual-picker slds-visual-picker_medium">
					<input type="checkbox" id="path_see" name="options" value="on" onchange="{!c.checkboxChange}"/>
					<label for="path_see" >
						<span class="slds-visual-picker__figure slds-visual-picker__icon slds-align_absolute-center">
							<span class="slds-is-selected">
								<lightning:icon iconName="action:check" variant="none" size="large"/>
							</span>
							<span class="slds-is-not-selected">
								<!-- <lightning:icon iconName="action:close" variant="none" size="large" /> -->
								<img src="https://raw.githubusercontent.com/mshanemc/platformTrial/33f3ee6e4c2487b6e76744bed573d3458f37c0fc/assets/Codey_lightning_laptop.png"/>
							</span>
						</span>
						<span class="slds-visual-picker__body">
							<h1 class="slds-text-heading_medium"><b>Apps in Action</b></h1>
							<p>I want to see employees experience apps built on Salesforce</p>
						</span>
					</label>
					<input type="checkbox" id="path_build" name="options" value="on" onchange="{!c.checkboxChange}"/>
					<label for="path_build">
						<span class="slds-visual-picker__figure slds-visual-picker__icon slds-align_absolute-center">
							<span class="slds-is-selected">
								<lightning:icon iconName="action:check" variant="none" size="large" />
							</span>
							<span class="slds-is-not-selected">
								<!-- <lightning:icon iconName="action:close" variant="none" size="large" /> -->
								<img src="https://raw.githubusercontent.com/mshanemc/platformTrial/33f3ee6e4c2487b6e76744bed573d3458f37c0fc/assets/Astro_lightning_welder.png"/>
							</span>
						</span>
						<span class="slds-visual-picker__body">
							<h1 class="slds-text-heading_medium"><b>App Building</b></h1>
							<p>I want to see how administrators and developers build the apps</p>
						</span>
					</label>
				</div>
			</div>
		</fieldset>


		<lightning:layout horizontalAlign="end">
			<lightning:layoutItem>
				<lightning:button variant="brand" label="Next" onclick="{!c.pathsSet}" disabled="{!!or(v.trialFieldsE.Path_See_Apps__c, v.trialFieldsE.Path_See_Apps__c)}" />
			</lightning:layoutItem>
		</lightning:layout>

		<!-- <lightning:layout horizontalAlign="space" verticalAlign="center" class="background" multipleRows="true" pullToBoundary="large">
			<lightning:layoutItem flexibility="auto" size="7" padding="around-large">
				<h1 class="slds-text-heading_large slds-m-bottom_large">What would you like to see?</h1>

				<p class="slds-text-heading_medium slds-m-bottom_medium" >Click all that apply.  We'll make sure that your tour focuses on those items. </p>


			</lightning:layoutItem>
			<lightning:layoutItem flexibility="auto" size="2" padding="around-large">
				<aura:if isTrue="{!or(or(v.trialFieldsE.Path_See_Apps__c, v.trialFieldsE.Path_Mobile__c), v.trialFieldsE.Path_Build_Apps__c)}">
						<lightning:button variant="neutral" label="Next!" class="slds-button_huge" onclick="{!c.pathsSet}" />
				</aura:if>
			</lightning:layoutItem>

			<lightning:layoutItem flexibility="grow" size="4" padding="around-large">
				<div class="{!'selection_box slds-p-around_large' + if(v.trialFieldsE.Path_See_Apps__c, ' selected', '')}">
					<h1 class="slds-text-heading_large slds-m-around_large slds-align_absolute-center">Apps in Action</h1>
					<p class="slds-text-heading_medium slds-m-around_large slds-align_absolute-center">I want to see employees experience apps built on Salesforce</p>
					<aura:if isTrue="{!!v.trialFieldsE.Path_See_Apps__c}">
						<lightning:button label="Select" value="Path_See_Apps__c" onclick="{!c.select}" variant="brand" class="slds-align_absolute-center slds-button_huge"/>
					</aura:if>
					<aura:if isTrue="{!v.trialFieldsE.Path_See_Apps__c}">
						<lightning:button label="Remove" value="Path_See_Apps__c" onclick="{!c.select}" variant="neutral" class="slds-align_absolute-center slds-button_huge"/>
					</aura:if>
				</div>

			</lightning:layoutItem> -->

			<!-- <lightning:layoutItem flexibility="grow" size="4" padding="around-large">
				<div class="{!'selection_box slds-p-around_large' + if(v.trialFieldsE.Path_Mobile__c, ' selected', '')}">
					<h1 class="slds-text-heading_large slds-m-around_large slds-align_absolute-center">Mobile Apps</h1>
					<p class="slds-text-heading_medium slds-m-around_large slds-align_absolute-center">I want to try the apps on my phone using Salesforce1</p>
					<aura:if isTrue="{!!v.trialFieldsE.Path_Mobile__c}">
						<lightning:button label="Select" value="Path_Mobile__c" onclick="{!c.select}" variant="brand" class="slds-align_absolute-center slds-button_huge"/>
					</aura:if>
					<aura:if isTrue="{!v.trialFieldsE.Path_Mobile__c}">
						<lightning:button label="Remove" value="Path_Mobile__c" onclick="{!c.select}" variant="neutral" class="slds-align_absolute-center slds-button_huge"/>
					</aura:if>
				</div>
			</lightning:layoutItem> -->

			<!-- <lightning:layoutItem flexibility="grow" size="4" padding="around-large">
				<div class="{!'selection_box slds-p-around_large' + if(v.trialFieldsE.Path_Build_Apps__c, ' selected', '')}">
					<h1 class="slds-text-heading_large slds-m-around_large slds-align_absolute-center">App Building</h1>
					<p class="slds-text-heading_medium slds-m-around_large slds-align_absolute-center">I want to see how administrators and developers build the apps</p>
					<aura:if isTrue="{!!v.trialFieldsE.Path_Build_Apps__c}">
						<lightning:button label="Select" value="Path_Build_Apps__c" onclick="{!c.select}" variant="brand" class="slds-align_absolute-center slds-button_huge"/>
					</aura:if>
					<aura:if isTrue="{!v.trialFieldsE.Path_Build_Apps__c}">
						<lightning:button label="Remove" value="Path_Build_Apps__c" onclick="{!c.select}" variant="neutral" class="slds-align_absolute-center slds-button_huge"/>
					</aura:if>
				</div>
			</lightning:layoutItem>

		</lightning:layout> -->

		<c:UniversalAnalyticsPageTag pageName="/welcome/choosePath" pageTitle="choosePath"/>
	</aura:if>


	<!-- story setup-->
	<!-- <aura:if isTrue="{!and(v.trialFields, and(v.trialFields.Paths_Chosen__c, !v.trialFields.Video_Watched__c))}">
		<lightning:layout horizontalAlign="space" verticalAlign="center" class="background" multipleRows="true" pullToBoundary="large">
			<lightning:layoutItem size="6" padding="around-large">
				<h1 class="slds-text-heading_large slds-m-bottom_large">Orientation</h1>

				<p class="slds-text-heading_small slds-m-vertical_medium">Please watch this orientation video to get you started.</p>

				<p class="slds-text-heading_medium slds-m-vertical_medium">
					Welcome to the SuperRangers!  We're a team of superheroes working to protect the world from the bad guys.
				</p>
				<p class="slds-text-heading_medium slds-m-vertical_medium">
					Like any organization, there's always more work than there is time, so we use Salesforce keep everyone connected and moving in the same direction.  Salesforce helps us track high-level contacts, plan missions, and organize equipment, as well non-heroic things like getting questions answered and coordinating our volunteer activities.
				</p>
				<p class="slds-text-heading_medium slds-m-vertical_medium">
					The Avengers poached our last Salesforce expert, so we're really glad you've stepped in to help us out.
				</p>
				<p class="slds-text-heading_medium slds-m-vertical_medium">
					We'll take you on a tour of how we use Salesforce and what we've built.  Your mission, should you choose to accept it, is to make saving the world easier.
				</p>

			</lightning:layoutItem>
			<lightning:layoutItem size="4" padding="around-large">
				<img src="http://via.placeholder.com/600x600"/>
			</lightning:layoutItem>
			<lightning:layoutItem size="3">
				<lightning:button variant="neutral" label="I read it.  I'm in!" class="slds-button_huge" onclick="{!c.storySet}"/>
				<c:ValueSettingButton variant="neutral" label="I read it.  I'm in!" value="true" recordId="{!v.recordId}" field="Video_Watched__c" valueType="boolean" class="slds-button_huge"/>
			</lightning:layoutItem>


			<lightning:layoutItem size="2"/>
			<lightning:layoutItem size="4" padding="around-large">
				<c:ValueSettingButton variant="neutral" label="I read it.  I'm in!" value="true" recordId="{!v.recordId}" field="Video_Watched__c" valueType="boolean" class="slds-button_huge"/>
			</lightning:layoutItem>
			<lightning:layoutItem size="10" padding="around-large">
				<c:youtubeVideoComponent videoId="OsC_zMcStro" startTime="35"/>
			</lightning:layoutItem>
		</lightning:layout>

		<c:UniversalAnalyticsPageTag pageName="/welcome/orientationVideo" pageTitle="orientationVideo"/>

	</aura:if> -->

	<!-- <aura:if isTrue="{!and(v.trialFields, v.trialFields.Video_Watched__c)}">
		<lightning:layout class="background" horizontalAlign="space" verticalAlign="center" >
			<lightning:layoutItem>
				<h1 class="slds-text-heading_large slds-m-bottom_large">placeholder</h1>
			</lightning:layoutItem>
		</lightning:layout>


		<c:UniversalAnalyticsPageTag pageName="/welcome/ready" pageTitle="ready"/>

	</aura:if> -->

	<!--default content if you've already completed the intro-->
	<!-- <aura:if isTrue="{!and(v.trialFields, and(v.trialFields.WelcomeViewed__c, v.trialFields.Paths_Chosen__c))}">
		<lightning:layout horizontalAlign="space" verticalAlign="center" class="background" multipleRows="true" pullToBoundary="large">
			<lightning:layoutItem size="6" padding="around-large">
				<p class="slds-text-heading_medium slds-m-vertical_medium">
					Looks like you've already completed the Platform Trial Welcome
				</p>
				<p class="slds-text-heading_medium slds-m-vertical_medium">
					Look under Current Task to see what to do next, or, if you're done, try exploring
				</p>
				<p class="slds-text-heading_medium slds-m-vertical_medium">
					<ul class="slds-list_dotted">
						<li>Other apps in the app launcher</li>
						<li>The Setup menu (under the gear in the top right)</li>
						<li><a href="https://trailhead.salesforce.com/">Trailhead</a></li>
					</ul>
				</p>
			</lightning:layoutItem>
		</lightning:layout>
	</aura:if> -->


	<aura:if isTrue="{!v.recordId}">
		<c:UniversalAnalytics aura:id="wua" location="welcome"/>
	</aura:if>




</aura:component>